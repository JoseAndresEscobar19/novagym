{% extends "main.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block main %}
<div class="row mt-4">
  <div class="col">
    <h2 class="text-left">NOTIFICACIONES</h2>
  </div>
  <div class="col">
    <a href="{% url 'notificaciones:crear' %}" class="btn btn-primary float-right" style="margin-right: 2%;">Agregar
      notificación <i class="fas fa-plus-circle"> </i></a>
  </div>
  <hr>
</div>
<div class="row mt-4">
  <div class="col-12">
    <form method="get">
      {% include "export_records.html" %}
    </form>
  </div>
  <div class="col-12 table-container">
    <table class="table table-responsive-lg table-condensed table-hover text-left" id="tabla-sponsor">
      <tr>
        <th scope="col">Imagen</th>
        <th scope="col">Título</th>
        <th scope="col">Cuerpo</th>
        <th scope="col">Horarios</th>
        <th scope="col">Frecuencia</th>
        <th scope="col">Estado</th>
        <th scope="col">Acciones</th>
      </tr>
      {% if page_obj %}
      {% for notificacion in page_obj %}
      <tr>
        <td><img style="width: 150px; height: 150px;" src="/media/{{notificacion.imagen}}" alt=""></td>
        <td>
          {{ notificacion.titulo }}
        </td>
        <td>
          {{ notificacion.cuerpo }}
        </td>
        <td>
          {{ notificacion.fecha_hora_inicio }} - {{ notificacion.fecha_hora_fin }}
        </td>
        <td>
          {{ notificacion.frecuencia }}
        </td>
        <td>
          {%if notificacion.activo %}
          <span class="text-success">Activo</span>
          {%else%}
          <span class="text-danger">Inactivo</span>
          {%endif%}
        </td>
        <td>
          <div class="d-inline">
            <div class="float-left">
              <a class="btn btn-sm btn-warning" href="{%url 'notificaciones:notificacionGlobal' notificacion.id%}"><i
                class="fas fa-bullhorn "></i></a>
            </div>
            <div >
          <a href="{%url 'notificaciones:update' notificacion.id%}" class="btn btn-sm btn-primary">
            <i class="fas fa-edit "></i></a>


          {% if notificacion.activo %}
          <a class="btn btn-sm btn-success" href="{%url 'notificaciones:change' notificacion.id%}"><i
              class="fas fa-power-off "></i></a>
          {% else %}
          <a class="btn btn-sm btn-warning" href="{%url 'notificaciones:change' notificacion.id%}"><i
              class="fas fa-power-off "></i></a>
          {% endif %}
          <a class="btn btn-sm btn-danger use-modal" data-toggle='modal' data-target="#mainModal"
            data-url="{%url 'notificaciones:eliminar' notificacion.id%}" href="#">
            <i class="fas fa-times "></i></a>
        </div>
</div>
        </td>
      </tr>
      {% endfor %}
      {% else %}
      <h4>
        No se encontraron datos.
      </h4>
      {% endif %}
    </table>
    {% include "pagination.html" %}
  </div>
</div>
{% endblock main %}

{% block specific_scripts %}
<script type="text/javascript" src="{% static 'js/moment.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/daterangepicker.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/bootstrap4-toggle.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/utilsDates.js' %}"></script>
<script type="text/javascript" src="{% static 'js/utilsModal2.js' %}"></script>
<script>
  $(".export").click(function () {
    $("#export").val($(this).data('value'));
    $('form').submit()
  });
  $('button[type="submit"]').click(function (e) {
    $("#export").val('');
  })
</script>
{% endblock %}